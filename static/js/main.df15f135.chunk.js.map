{"version":3,"sources":["Helper.js","PortraitPanel.js","BackgroundPanel.js","LayerDeletePrompt.js","LayersPanel.js","SettingsPanel.js","Footer.js","images/examplePortrait.png","images/exampleBackground.png","images/bar.png","images/caption.png","images/book.png","images/fullscreen.png","images/introBack.png","images/introBar.png","images/skip_ja.png","images/skip_zh_tw.png","images/images.js","images/skip_en.png","images/anger_l.png","images/anger_r.png","images/bad_l.png","images/bad_r.png","images/exclamation_l.png","images/exclamation_r.png","images/heart_l.png","images/heart_r.png","images/inspiration_l.png","images/inspiration_r.png","images/note_l.png","images/note_r.png","images/notice_l.png","images/notice_r.png","images/question_l.png","images/question_r.png","images/sleep_l.png","images/sleep_r.png","images/sweat_l.png","images/sweat_r.png","App.js","reportWebVitals.js","index.js"],"names":["id","elementId","document","getElementById","fetchJson","url","a","fetch","response","ok","json","Error","text","console","error","loadImage","src","img","Image","crossOrigin","Promise","resolve","reject","onload","onerror","portraitCanvas","PORTRAIT_URL","pageLang","documentElement","lang","PortraitPanel","props","state","fileList","face","mouth","portraitData","createElement","width","height","validateDatalistInput","bind","updatePortraitData","this","populatePortraitData","loc","options","Object","keys","map","key","value","i18n","code","faceParts","FacePartImage","substring","mouthParts","MouthPartImage","className","active","title","href","target","rel","link","type","autoComplete","list","onChange","setState","e","option","querySelector","loadSelectedPortraitData","dataset","charId","characterName","data","partsData","name","base","offset","drawPortraitAndRender","ctx","getContext","clearRect","baseImage","drawImage","faceImage","x","y","mouthImage","toBlob","blob","URL","createObjectURL","updateLayer","activeLayer","image","updatedValue","prevState","assign","React","Component","onClick","alt","BackgroundPanel","newData","i","length","undefined","push","backgroundData","full","images","background","skybox","cloud","overlay","BackgroundCarousel","index","previousPage","nextPage","backgroundImages","slice","fileName","newIndex","LayerDeletePrompt","deleteLayerConfirm","removeLayer","closePrompt","delete","cancel","LayerTab","activeTab","layer","useSortable","attributes","listeners","setNodeRef","transform","transition","isActive","style","ref","LayerTabPane","portraitPanelActive","backgroundPanelActive","togglePortraitPanel","toggleBackgroundPanel","openPrompt","drawDialogueScreen","layerImage","reccomendedSize","onLoad","accept","window","files","deleteLayer","portrait","layerName","placeholder","defaultValue","opacity","min","max","step","offsetX","offsetY","rotation","scale","flipX","defaultChecked","checked","LayersPanel","layers","addLayer","reorderLayer","useState","activeTabId","setActiveTab","setPortraitPanelActive","setBackgroundPanelActive","deletePanelActive","setDeletePanelActive","prevLayers","useRef","useEffect","current","usePrevious","mouseSensor","useSensor","MouseSensor","activationConstraint","distance","touchSensor","TouchSensor","sensors","useSensors","items","tabContents","lyr","tabs","tabContent","onDragEnd","collisionDetection","closestCenter","modifiers","snapCenterToCursor","restrictToWindowEdges","strategy","rectSortingStrategy","SettingsPanel","settings","updateSettings","innerText","generating","download","toLowerCase","click","speakerName","speaker","dialogueText","cols","rows","dialogueType","htmlFor","stdialogue_dialogue","stdialogue_intro","stdialogue_caption","stdialogue_full","stdialogue_narration","stdialogue_book","font","font_en","font_ja","font_zh_tw","font_zh_cn","emotion","emotion_none","emotion_anger","emotion_bad","emotion_exclamation","emotion_heart","emotion_inspiration","emotion_note","emotion_notice","emotion_question","emotion_sleep","emotion_sweat","emotionSide","emotion_side","left","right","emotion_x","emotionOffsetX","emotion_y","emotionOffsetY","Footer","setLanguage","frameBorder","maxWidth","footer","disclaimer","border","verticalAlign","bar","caption","book","fullscreen","introBack","introBar","skip_ja","skip_zh_tw","skip_zh_cn","skip_en","anger_l","anger_r","bad_l","bad_r","exclamation_l","exclamation_r","heart_l","heart_r","inspiration_l","inspiration_r","note_l","note_r","notice_l","notice_r","question_l","question_r","sleep_l","sleep_r","sweat_l","sweat_r","textures","drawing","layerId","App","savedLang","localStorage","getItem","bcp47","default","deletePromptActive","addLayerDefault","initialDraw","language","setItem","fonts","load","canvas","preview","ctxPreview","loadTextures","drawImageWithData","drawEmotion","drawDialogueText","loaded","centerX","centerY","dropShadow","parseFloat","naturalWidth","naturalHeight","save","translate","rotate","Math","PI","shadowColor","shadowOffsetX","shadowOffsetY","globalAlpha","restore","emotionName","textProp","textProperties","dialogue","textAlign","nameSize","fillStyle","titleSize","fillText","measureText","titleYPos","fillRect","drawSpeakerNameIntro","speakerXPos","speakerYPos","lines","split","fontSize","dialogueSize","lineHeight","startX","dialogueXPos","startY","dialogueYPos","center","captionYPos","captionSize","narrationLineHeight","narrationYPos","replace","match","furigana","string","drawDialogueLine","drawTitleIntro","tmp","last","normalFont","furiganaFont","furiganaX","furiganaY","introNameSize","textWidth","introNameYPos","strokeStyle","lineWidth","miterLimit","strokeText","introXPos","introTitleSize","introTitleYPos","imgSrc","newLayer","getNewId","filter","result","over","fromIndex","findIndex","toIndex","dir","updateLayerId","updated","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.df15f135.chunk.js","sourcesContent":["/**\r\n * Shorthand for document.getElementById\r\n * @param {string} elementId - id of the element to get\r\n * @returns {Element} - element with the id\r\n */\r\nfunction id(elementId) {\r\n  return document.getElementById(elementId);\r\n}\r\n\r\n/**\r\n * Shorthand for document.querySelector\r\n * @param {string} selector - selector of the element to get\r\n * @returns {Element} - first element matching the selector\r\n */\r\nfunction qs(selector) {\r\n  return document.querySelector(selector);\r\n}\r\n\r\n/**\r\n * Shorthand for document.querySelectorAll\r\n * @param {string} selector - selector of the elements to get\r\n * @returns {NodeList} - element that matches at least one of the specified selectors\r\n */\r\nfunction qsa(selector) {\r\n  return document.querySelectorAll(selector);\r\n}\r\n\r\n/**\r\n * Returns the tab to append before based on the position\r\n * @param {number} x - x position of the event\r\n * @param {number} y - y position of the event\r\n * @returns {HTMLLIElement} - tab that comes after the position\r\n */\r\nfunction getDragAfterElement(x, y) {\r\n  const tabs = [...qsa(\".tab-bar li:not(#addLayer, .dragging)\")];\r\n\r\n  let after = null;\r\n  let afterRightMost = -1;\r\n  let minXOffset = Number.POSITIVE_INFINITY;\r\n  let minYOffset = Number.POSITIVE_INFINITY;\r\n  let maxBoxY = 0;\r\n  let maxBoxX = 0;\r\n\r\n  for(let i = 0; i < tabs.length; i++) {\r\n    const box = tabs[i].getBoundingClientRect();\r\n    const boxY = box.top + box.height / 2;\r\n    if(boxY > maxBoxY) {\r\n      maxBoxY = boxY;\r\n    }\r\n  }\r\n\r\n  for(let i = 0; i < tabs.length; i++) {\r\n    const tab = tabs[i];\r\n    const box = tab.getBoundingClientRect();\r\n    const offsetX = x - (box.right - box.width / 2);\r\n    const offsetY = y - box.bottom;\r\n\r\n    // The tab is on the row if the mouse is above the row\r\n    const activeRow = offsetY < 0 && -offsetY <= minYOffset\r\n    if(activeRow) {\r\n      minYOffset = Math.abs(offsetY);\r\n\r\n      if(offsetX < 0) {\r\n        if(-offsetX < minXOffset) {\r\n          after = tab;\r\n          minXOffset = -offsetX;\r\n        }\r\n      }\r\n      else if(box.right > maxBoxX) {\r\n        maxBoxX = box.right;\r\n        afterRightMost = i + 1;\r\n      }\r\n    }\r\n  }\r\n\r\n  if(after === null && afterRightMost >= 0 && afterRightMost < tabs.length - 1) {\r\n    after = tabs[afterRightMost];\r\n  }\r\n\r\n  return after;\r\n}\r\n\r\n/**\r\n * Returns the JSON object from the response of a request to the URL\r\n * @param {string} url - url to fetch from\r\n * @returns {Object} JSON object fron response\r\n */\r\nasync function fetchJson(url) {\r\n  try {\r\n    let response = await fetch(url);\r\n    if(response.ok) {\r\n      let json = await response.json();\r\n      return json;\r\n    } else {\r\n      throw new Error(await response.text());\r\n    }\r\n  } catch (e) {\r\n    console.error(e);\r\n  }\r\n}\r\n\r\n/**\r\n * Creates and returns the image element with given souce\r\n * @param {string} src - source of the image\r\n * @returns {Promise} - resolves to the image element if the image loads successfully\r\n */\r\nfunction loadImage(src){\r\n  let img = new Image();\r\n  img.crossOrigin = \"anonymous\";\r\n  img.src = src;\r\n  return new Promise((resolve, reject) => {\r\n    img.onload = () => resolve(img);\r\n    img.onerror = reject;\r\n  });\r\n}\r\n\r\nexport { id, qs, qsa, fetchJson, loadImage, getDragAfterElement };","import './PortraitPanel.css';\r\nimport React from \"react\";\r\nimport i18n from './data/i18n.json';\r\nimport { fetchJson, loadImage } from './Helper.js';\r\n\r\n// Portrait drawing data\r\nconst PORTRAIT_URL = \"https://dlportraits.space/\";\r\nlet pageLang = document.documentElement.lang;\r\nlet portraitCanvas;\r\n\r\nclass PortraitPanel extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      fileList: {},\r\n      face: [],\r\n      mouth: [],\r\n      portraitData: {}\r\n    };\r\n\r\n    portraitCanvas = document.createElement(\"canvas\");\r\n    portraitCanvas.width = 1024;\r\n    portraitCanvas.height = 1024;\r\n\r\n    this.validateDatalistInput = this.validateDatalistInput.bind(this);\r\n    this.updatePortraitData = this.updatePortraitData.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.populatePortraitData();\r\n  }\r\n\r\n  render() {\r\n    const { loc } = this.props\r\n\r\n    const options = Object.keys(this.state.fileList).map(key => {\r\n      return <option key={key} value={this.state.fileList[key][i18n[pageLang].code]} data-id={key} />\r\n    });\r\n\r\n    const faceParts = this.state.face.map(face => {\r\n      return <FacePartImage key={face} src={PORTRAIT_URL + face.substring(2)} updatePortraitData={this.updatePortraitData} />\r\n    });\r\n\r\n    const mouthParts = this.state.mouth.map(mouth => {\r\n      return <MouthPartImage key={mouth} src={PORTRAIT_URL + mouth.substring(2)} updatePortraitData={this.updatePortraitData} />\r\n    });\r\n\r\n    return (\r\n      <div id=\"portraitPanel\" className={`${this.props.active ? '' : 'hidden'}`}>\r\n        <h3>{loc.title}<a href=\"https://dlportraits.space/\" target=\"_blank\" rel=\"noreferrer\">{loc.link}</a>)</h3>\r\n        <input type=\"text\" autoComplete=\"off\" list=\"portraitList\" onChange={this.validateDatalistInput} />\r\n        <datalist id=\"portraitList\">\r\n          {options}\r\n        </datalist>\r\n        <br />\r\n        <label>{loc.face}</label>\r\n        <hr />\r\n        <div className='image-container'>\r\n          {faceParts}\r\n        </div>\r\n        <label>{loc.mouth}</label>\r\n        <hr />\r\n        <div className='image-container'>\r\n          {mouthParts}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Fetches data for the available portraits\r\n   */\r\n  async populatePortraitData() {\r\n    let portraitData = await fetchJson(PORTRAIT_URL + \"portrait_output/localizedDirData.json\");\r\n    this.setState({ fileList: portraitData.fileList });\r\n  }\r\n\r\n  /**\r\n   * Validates the portrait input to match options in datalist\r\n   */\r\n  validateDatalistInput(e) {\r\n    let option = document.querySelector(`#portraitList option[value=\"${e.target.value}\"]`);\r\n    if (option !== null) {\r\n      this.loadSelectedPortraitData(option.dataset.id, e.target.value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Gets data about the portrait of the character with the given id\r\n   * @param {string} charId - id of the character\r\n   */\r\n  async loadSelectedPortraitData(charId, characterName) {\r\n    let data = await fetchJson(PORTRAIT_URL + `portrait_output/${charId}/data.json`);\r\n\r\n    this.setState({\r\n      face: data.partsData.faceParts,\r\n      mouth: data.partsData.mouthParts,\r\n      portraitData: {\r\n        name: characterName,\r\n        face: PORTRAIT_URL + data.partsData.faceParts[0].substring(2),\r\n        mouth: PORTRAIT_URL + data.partsData.mouthParts[0].substring(2),\r\n        base: PORTRAIT_URL + `portrait_output/${charId}/${charId}_base.png`,\r\n        offset: data.offset,\r\n      }\r\n    }, this.drawPortraitAndRender);\r\n  }\r\n\r\n  /**\r\n   * Draws the portrait on the portrait canvas and sets the image source of the\r\n   * current tab to the portrait canvas\r\n   */\r\n  async drawPortraitAndRender() {\r\n    const ctx = portraitCanvas.getContext(\"2d\");\r\n    ctx.clearRect(0, 0, portraitCanvas.width, portraitCanvas.height);\r\n\r\n    const baseImage = await loadImage(this.state.portraitData.base);\r\n    ctx.drawImage(baseImage, 0, 0);\r\n\r\n    if (this.state.portraitData.face !== \"\") {\r\n      const faceImage = await loadImage(this.state.portraitData.face);\r\n      ctx.drawImage(faceImage, this.state.portraitData.offset.x, this.state.portraitData.offset.y);\r\n    }\r\n\r\n    if (this.state.portraitData.mouth !== \"\") {\r\n      const mouthImage = await loadImage(this.state.portraitData.mouth);\r\n      ctx.drawImage(mouthImage, this.state.portraitData.offset.x, this.state.portraitData.offset.y);\r\n    }\r\n\r\n    const blob = await new Promise(resolve => portraitCanvas.toBlob(resolve));\r\n    const url = URL.createObjectURL(blob);\r\n\r\n    this.props.updateLayer(this.props.activeLayer, { image: url });\r\n  }\r\n\r\n  async updatePortraitData(updatedValue) {\r\n    this.setState(prevState => { return { portraitData: Object.assign(prevState.portraitData, updatedValue) }; }, this.drawPortraitAndRender);\r\n  }\r\n}\r\n\r\nfunction FacePartImage(props) {\r\n  return <img src={props.src} onClick={() => props.updatePortraitData({ face: props.src })} alt='Face Part' />\r\n}\r\n\r\nfunction MouthPartImage(props) {\r\n  return <img src={props.src} onClick={() => props.updatePortraitData({ mouth: props.src })} alt='Mouth Part' />\r\n}\r\n\r\nexport default PortraitPanel;","import React from 'react';\r\nimport data from './data/background_data.json';\r\n\r\nconst THUMB_URL = 'https://dragalialost.wiki/thumb.php?width=75&f='\r\nconst CarouselSize = 12;\r\n\r\nclass BackgroundPanel extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    let newData = {}\r\n    for(let i = 0; i < data.length; i++) {\r\n      if(newData[data[i].type] === undefined) {\r\n        newData[data[i].type] = [];\r\n      }\r\n      newData[data[i].type].push(data[i]);\r\n    }\r\n\r\n    this.state = {\r\n      backgroundData: newData\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { loc } = this.props;\r\n    return (\r\n      <div id=\"backgroundPanel\" className={`${this.props.active ? '' : 'hidden'}`}>\r\n        <h3>{loc.title}<a href=\"https://dragalialost.wiki/w/Category:Background_Art\" target=\"_blank\" rel=\"noreferrer\">{loc.link}</a>)</h3>\r\n        <div>\r\n          <label>{loc.full}</label>\r\n          <hr />\r\n          <BackgroundCarousel images={this.state.backgroundData.background} activeLayer={this.props.activeLayer} updateLayer={this.props.updateLayer} />\r\n          <label>{loc.skybox}</label>\r\n          <hr />\r\n          <BackgroundCarousel images={this.state.backgroundData.skybox} activeLayer={this.props.activeLayer} updateLayer={this.props.updateLayer} />\r\n          <label>{loc.cloud}</label>\r\n          <hr />\r\n          <BackgroundCarousel images={this.state.backgroundData.cloud} activeLayer={this.props.activeLayer} updateLayer={this.props.updateLayer} />\r\n          <label>{loc.overlay}</label>\r\n          <hr />\r\n          <BackgroundCarousel images={this.state.backgroundData.overlay} activeLayer={this.props.activeLayer} updateLayer={this.props.updateLayer} />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n\r\nclass BackgroundCarousel extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      index: 0\r\n    };\r\n\r\n    this.previousPage = this.previousPage.bind(this);\r\n    this.nextPage = this.nextPage.bind(this);\r\n  }\r\n\r\n  render() {\r\n    const backgroundImages = this.props.images.slice(this.state.index, this.state.index + CarouselSize).map(image => {\r\n      return (\r\n        <img\r\n          key={image.fileName}\r\n          src={THUMB_URL + image.fileName}\r\n          data-full-src={image.url}\r\n          onClick={() => this.props.updateLayer(this.props.activeLayer, { image: image.url })}\r\n          alt='Background'\r\n        />\r\n      );\r\n    });\r\n\r\n    return (\r\n      <div className=\"carousel\">\r\n        <button className=\"button\" onClick={this.previousPage}>&lt;</button>\r\n          <div className=\"image-container\">\r\n            {backgroundImages}\r\n          </div>\r\n        <button className=\"button\" onClick={this.nextPage}>&gt;</button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  previousPage() {\r\n    this.setState((prevState) => {\r\n      let newIndex = prevState.index - CarouselSize;\r\n      if(newIndex < 0) {\r\n        newIndex = 0;\r\n      }\r\n      return { index: newIndex };\r\n    });\r\n  }\r\n\r\n  nextPage() {\r\n    this.setState((prevState) => {\r\n      let newIndex = prevState.index + CarouselSize;\r\n      if(newIndex >= this.props.images.length) {\r\n        return { index: prevState.index };\r\n      } else {\r\n        return { index: newIndex };\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nexport default BackgroundPanel;","import './LayerDeletePrompt.css';\r\nimport React from 'react';\r\n\r\nfunction LayerDeletePrompt (props) {\r\n  return (\r\n    <div className={`layer-delete-prompt ${props.active ? '' : 'hidden'}`}>\r\n      <div>\r\n        <p>{props.loc.deleteLayerConfirm}</p>\r\n        <button className='button delete' onClick={() => { props.removeLayer(); props.closePrompt(); } }>{props.loc.delete}</button>\r\n        <button className='button' onClick={props.closePrompt}>{props.loc.cancel}</button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default LayerDeletePrompt;","import './LayersPanel.css';\r\nimport PortraitPanel from './PortraitPanel.js';\r\nimport BackgroundPanel from './BackgroundPanel.js';\r\nimport LayerDeletePrompt from './LayerDeletePrompt.js';\r\nimport React, { useRef, useEffect, useState } from 'react';\r\nimport { DndContext, useSensor, useSensors, MouseSensor, TouchSensor, closestCenter } from '@dnd-kit/core';\r\nimport { SortableContext, useSortable, rectSortingStrategy } from '@dnd-kit/sortable';\r\nimport { restrictToWindowEdges, snapCenterToCursor } from '@dnd-kit/modifiers';\r\nimport i18n from './data/i18n.json';\r\n\r\nconst usePrevious = (value) => {\r\n  const ref = useRef();\r\n  useEffect(() => {\r\n    ref.current = value;\r\n  });\r\n  return ref.current;\r\n}\r\n\r\nfunction LayersPanel(props) {\r\n  const { layers, drawDialogueScreen, addLayer, removeLayer, updateLayer, reorderLayer, pageLang } = props;\r\n  const [ activeTabId, setActiveTab ] = useState(2);\r\n  const [ portraitPanelActive, setPortraitPanelActive ] = useState(false);\r\n  const [ backgroundPanelActive, setBackgroundPanelActive ] = useState(false);\r\n  const [ deletePanelActive, setDeletePanelActive ] = useState(false);\r\n  const loc = i18n[pageLang].loc.layers\r\n\r\n  const prevLayers = usePrevious(layers);\r\n\r\n  useEffect(() => {\r\n    if (layers && layers.length > 0 && prevLayers && prevLayers.length !== layers.length) {\r\n      setActiveTab(layers[layers.length - 1].id);\r\n    }\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [layers]);\r\n\r\n  const togglePortraitPanel = () => {\r\n    setPortraitPanelActive(!portraitPanelActive);\r\n    setBackgroundPanelActive(false);\r\n  }\r\n\r\n  const toggleBackgroundPanel = () => {\r\n    setBackgroundPanelActive(!backgroundPanelActive);\r\n    setPortraitPanelActive(false);\r\n  }\r\n\r\n  const mouseSensor = useSensor(MouseSensor, {\r\n    activationConstraint: {\r\n      distance: 10,\r\n    }\r\n  });\r\n\r\n  const touchSensor = useSensor(TouchSensor, {\r\n    activationConstraint: {\r\n      distance: 5,\r\n    }\r\n  });\r\n\r\n  const sensors = useSensors(mouseSensor, touchSensor);\r\n\r\n  const items = [];\r\n\r\n  const tabContents = layers.map(\r\n    (lyr) => {\r\n      items.push(`tab_${lyr.id}`);\r\n      return <LayerTabPane\r\n        key={lyr.id}\r\n        layer={lyr}\r\n        active={lyr.id === activeTabId}\r\n        drawDialogueScreen={drawDialogueScreen}\r\n        togglePortraitPanel={togglePortraitPanel}\r\n        toggleBackgroundPanel={toggleBackgroundPanel}\r\n        openPrompt={() => setDeletePanelActive(true)}\r\n        portraitPanelActive={portraitPanelActive}\r\n        backgroundPanelActive={backgroundPanelActive}\r\n        updateLayer={updateLayer}\r\n        loc={loc}\r\n      />;\r\n    }\r\n  );\r\n\r\n  const tabs = tabContents.map(\r\n    (tabContent, index) =>\r\n      <LayerTab\r\n        key={`tab_${tabContent.props.layer.id}`}\r\n        layer={tabContent.props.layer}\r\n        onClick={setActiveTab}\r\n        activeTab={tabContent.props.layer.id === activeTabId}\r\n        index={index}\r\n      />\r\n  );\r\n\r\n  return (\r\n    <DndContext sensors={sensors} onDragEnd={reorderLayer} collisionDetection={closestCenter} modifiers={[snapCenterToCursor, restrictToWindowEdges]}>\r\n      <div>\r\n        <ul className='tab-bar'>\r\n          <SortableContext items={items} strategy={rectSortingStrategy}>\r\n            {tabs}\r\n          </SortableContext>\r\n          <li onClick={addLayer} id='addLayer'>+</li>\r\n        </ul>\r\n        <div>\r\n          {tabContents}\r\n        </div>\r\n        <PortraitPanel\r\n          active={portraitPanelActive}\r\n          activeLayer={activeTabId}\r\n          updateLayer={updateLayer}\r\n          loc={i18n[pageLang].loc.portrait}\r\n        />\r\n        <BackgroundPanel\r\n          active={backgroundPanelActive}\r\n          activeLayer={activeTabId}\r\n          updateLayer={updateLayer}\r\n          loc={i18n[pageLang].loc.background}\r\n        />\r\n      </div>\r\n      <LayerDeletePrompt\r\n        active={deletePanelActive}\r\n        removeLayer={() => removeLayer(activeTabId)}\r\n        closePrompt={() => setDeletePanelActive(false)}\r\n        loc={i18n[pageLang].loc}\r\n      />\r\n    </DndContext>\r\n  );\r\n}\r\n\r\nfunction LayerTab (props) {\r\n  const { activeTab, layer, onClick } = props;\r\n\r\n  const { active, attributes, listeners, setNodeRef, transform, transition } = useSortable({\r\n    id: `tab_${layer.id}`,\r\n    data: {\r\n      index: props.index\r\n    }\r\n  });\r\n\r\n  const isActive = active !== null && (active.id === `tab_${layer.id}`);\r\n\r\n  const style = {\r\n    transform: transform ? `translate3d(${transform.x}px, ${transform.y}px, 0)` : undefined,\r\n    transition\r\n  };\r\n\r\n\r\n  return (\r\n    <li\r\n      ref={setNodeRef}\r\n      style={style}\r\n      onClick={() => { onClick(layer.id) }}\r\n      {...listeners}\r\n      {...attributes}\r\n      id={`tab_${layer.id}`}\r\n      className={`${activeTab ? 'active' : ''} ${isActive ? 'dragging' : ''}`}\r\n    >\r\n      {layer.name.substring(0, 10)}\r\n    </li>\r\n  );\r\n}\r\n\r\nfunction LayerTabPane(props) {\r\n  const {\r\n    loc, layer, updateLayer, portraitPanelActive, backgroundPanelActive,\r\n    togglePortraitPanel, toggleBackgroundPanel, openPrompt, drawDialogueScreen,\r\n    active\r\n  } = props;\r\n  return (\r\n    <div className={`tab ${active ? 'active' : ''}`}>\r\n      <div>\r\n        <h2>{loc.layerImage}</h2>\r\n        <label>{loc.reccomendedSize}</label>\r\n        <img src={layer.image} alt='Layer' id={`img_${layer.id}`} onLoad={drawDialogueScreen} />\r\n        <input type='file' accept='image/*' onChange={e => { updateLayer(layer.id, { image: window.URL.createObjectURL(e.target.files[0]) }); }} />\r\n        <button className='button delete' onClick={openPrompt}>{loc.deleteLayer}</button>\r\n        <button className={`button ${portraitPanelActive ? 'selected' : ''}`} onClick={togglePortraitPanel}>{loc.portrait}</button>\r\n        <button className={`button ${backgroundPanelActive ? 'selected' : ''}`} onClick={toggleBackgroundPanel}>{loc.background}</button>\r\n      </div>\r\n      <div>\r\n        <div>\r\n          <label>{loc.layerName}</label>\r\n          <input type='text' placeholder={loc.layerName} defaultValue={layer.name} onChange={e => { updateLayer(layer.id, { name: e.target.value }); }} />\r\n        </div>\r\n        <div>\r\n          <label>{loc.opacity}</label>\r\n          <div className='input-group'>\r\n            <input type='number' min='0' max='1' step='0.01' value={layer.opacity} onChange={e => { updateLayer(layer.id, { opacity: e.target.value }); }} />\r\n            <input type='range' min='0' max='1' step='0.01' value={layer.opacity} onChange={e => { updateLayer(layer.id, { opacity: e.target.value }); }} />\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <label>{loc.offsetX}</label>\r\n          <div className='input-group'>\r\n            <input type='number' min='-400' max='400' step='1' value={layer.offsetX} onChange={e => { updateLayer(layer.id, { offsetX: e.target.value }); }} />\r\n            <input type='range' min='-400' max='400' step='1' value={layer.offsetX} onChange={e => { updateLayer(layer.id, { offsetX: e.target.value }); }} />\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <label>{loc.offsetY}</label>\r\n          <div className='input-group'>\r\n            <input type='number' min='-400' max='400' step='1' value={layer.offsetY} onChange={e => { updateLayer(layer.id, { offsetY: e.target.value }); }} />\r\n            <input type='range' min='-400' max='400' step='1' value={layer.offsetY} onChange={e => { updateLayer(layer.id, { offsetY: e.target.value }); }} />\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <label>{loc.rotation}</label>\r\n          <div className='input-group'>\r\n            <input type='number' min='-180' max='180' step='0.1' value={layer.rotation} onChange={e => { updateLayer(layer.id, { rotation: e.target.value }); }} />\r\n            <input type='range' min='-180' max='180' step='0.1' value={layer.rotation} onChange={e => { updateLayer(layer.id, { rotation: e.target.value }); }} />\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <label>{loc.scale}</label>\r\n          <div className='input-group'>\r\n            <input type='number' min='0' max='3' step='0.1' value={layer.scale} onChange={e => { updateLayer(layer.id, { scale: e.target.value }); }} />\r\n            <input type='range' min='0' max='3' step='0.1' value={layer.scale} onChange={e => { updateLayer(layer.id, { scale: e.target.value }); }} />\r\n          </div>\r\n          <label>{loc.flipX}</label>\r\n          <input type='checkbox' defaultChecked={layer.flipX} onChange={e => { updateLayer(layer.id, { flipX: e.target.checked }); }} />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default LayersPanel;","import React from 'react';\r\nimport i18n from './data/i18n.json';\r\nimport { id } from './Helper.js';\r\n\r\nfunction SettingsPanel(props) {\r\n  const { settings, updateSettings, pageLang } = props;\r\n  const loc = i18n[pageLang].loc.settings;\r\n\r\n  /**\r\n   * Generate a download link and click it\r\n   */\r\n  async function downloadImage(e) {\r\n    e.target.innerText = loc.generating;\r\n    const blob = await new Promise(resolve => id('editor').toBlob(resolve, 'image/png'));\r\n    e.target.innerText = loc.download;\r\n\r\n    let link = document.createElement('a');\r\n    link.href = URL.createObjectURL(blob);\r\n    link.download = `${id('name').value.toLowerCase()}_dialogue_screen.png`;\r\n    link.click();\r\n  }\r\n\r\n  return (\r\n    <div id='dialogueArea' className='settings'>\r\n\r\n      <div>\r\n        <label>{loc.speakerName}</label>\r\n        <input type='text' placeholder='Speaker Name' id='name' defaultValue={settings.speaker} onChange={e => updateSettings(settings.id, { speaker: e.target.value })} />\r\n      </div>\r\n\r\n      <div>\r\n        <label>{loc.dialogueText}</label>\r\n        <textarea id='dialogue' cols='45' rows='5' defaultValue={settings.dialogueText} onChange={e => updateSettings({ dialogueText: e.target.value })} ></textarea>\r\n      </div>\r\n\r\n      <div onChange={e => updateSettings({ dialogueType: e.target.value })} >\r\n        <label>{loc.dialogueType}</label>\r\n        <input type='radio' name='stdialogue' value='dialogue' id='std-dialogue' defaultChecked={settings.dialogueType === 'dialogue'} />\r\n        <label htmlFor='std-dialogue'>{loc.stdialogue_dialogue}</label>\r\n        <input type='radio' name='stdialogue' value='intro' id='std-intro' defaultChecked={settings.dialogueType === 'intro'} />\r\n        <label htmlFor='std-intro'>{loc.stdialogue_intro}</label>\r\n        <input type='radio' name='stdialogue' value='caption' id='std-caption' defaultChecked={settings.dialogueType === 'caption'} />\r\n        <label htmlFor='std-caption'>{loc.stdialogue_caption}</label>\r\n        <br />\r\n        <input type='radio' name='stdialogue' value='full' id='std-full' defaultChecked={settings.dialogueType === 'full'} />\r\n        <label htmlFor='std-full'>{loc.stdialogue_full}</label>\r\n        <input type='radio' name='stdialogue' value='narration' id='std-narration' defaultChecked={settings.dialogueType === 'narration'} />\r\n        <label htmlFor='std-narration'>{loc.stdialogue_narration}</label>\r\n        <input type='radio' name='stdialogue' value='book' id='std-book' defaultChecked={settings.dialogueType === 'book'} />\r\n        <label htmlFor='std-book'>{loc.stdialogue_book}</label>\r\n      </div>\r\n\r\n      <div onChange={e => updateSettings({ font: e.target.value })} >\r\n        <label>{loc.font}</label>\r\n        <input type='radio' id='en' name='font' value='en' defaultChecked={settings.font === 'en'} />\r\n        <label htmlFor='en'>{loc.font_en}</label>\r\n        <input type='radio' id='jp' name='font' value='ja' defaultChecked={settings.font === 'ja'} />\r\n        <label htmlFor='jp'>{loc.font_ja}</label>\r\n        <br />\r\n        <input type='radio' id='zh_tw' name='font' value='zh_tw' defaultChecked={settings.font === 'zh_tw'} />\r\n        <label htmlFor='zh_tw'>{loc.font_zh_tw}</label>\r\n        <input type='radio' id='zh_cn' name='font' value='zh_cn' defaultChecked={settings.font === 'zh_cn'} />\r\n        <label htmlFor='zh_cn'>{loc.font_zh_cn}</label>\r\n      </div>\r\n\r\n      <div>\r\n        <label>{loc.emotion}</label>\r\n        <select id='emotion' value={settings.emotion} onChange={e => updateSettings({ emotion: e.target.value })} >\r\n          <option value='none'>{loc.emotion_none}</option>\r\n          <option value='anger'>{loc.emotion_anger}</option>\r\n          <option value='bad'>{loc.emotion_bad}</option>\r\n          <option value='exclamation'>{loc.emotion_exclamation}</option>\r\n          <option value='heart'>{loc.emotion_heart}</option>\r\n          <option value='inspiration'>{loc.emotion_inspiration}</option>\r\n          <option value='note'>{loc.emotion_note}</option>\r\n          <option value='notice'>{loc.emotion_notice}</option>\r\n          <option value='question'>{loc.emotion_question}</option>\r\n          <option value='sleep'>{loc.emotion_sleep}</option>\r\n          <option value='sweat'>{loc.emotion_sweat}</option>\r\n        </select>\r\n      </div>\r\n\r\n      <div onChange={e => updateSettings({ emotionSide: e.target.value })}>\r\n        <label>{loc.emotion_side}</label>\r\n        <input type='radio' id='left' name='emotionside' value='l' defaultChecked={settings.emotionSide === 'l'} />\r\n        <label htmlFor='left'>{loc.left}</label>\r\n        <input type='radio' id='right' name='emotionside' value='r' defaultChecked={settings.emotionSide === 'r'} />\r\n        <label htmlFor='right'>{loc.right}</label>\r\n      </div>\r\n\r\n      <div>\r\n        <label>{loc.emotion_x}</label>\r\n        <div className='input-group'>\r\n          <input type='number' id='emotionOffsetX' min='-200' max='200' value={settings.emotionOffsetX} onChange={e => updateSettings({ emotionOffsetX: e.target.value })} />\r\n          <input type='range' min='-200' max='200' value={settings.emotionOffsetX} onChange={e => updateSettings({ emotionOffsetX: e.target.value })} />\r\n        </div>\r\n      </div>\r\n\r\n      <div>\r\n        <label>{loc.emotion_y}</label>\r\n        <div className='input-group'>\r\n          <input type='number' id='emotionOffsetY' min='-200' max='200' value={settings.emotionOffsetY} onChange={e => updateSettings({ emotionOffsetY: e.target.value })} />\r\n          <input type='range' min='-200' max='200' value={settings.emotionOffsetY} onChange={e => updateSettings({ emotionOffsetY: e.target.value })} />\r\n        </div>\r\n      </div>\r\n\r\n      <div>\r\n        <button className='button' id='download' onClick={downloadImage}>{loc.download}</button>\r\n      </div>\r\n\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default SettingsPanel;","import i18n from './data/i18n.json'\r\n\r\nfunction Footer(props) {\r\n  const { pageLang, setLanguage } = props;\r\n  return (\r\n    <footer>\r\n      {\r\n        pageLang === 'en' ?\r\n        <iframe\r\n          title='Steam Widget'\r\n          src='https://store.steampowered.com/widget/1764410/'\r\n          frameBorder='0'\r\n          height='190'\r\n          style={{\r\n            width: '100%',\r\n            maxWidth: '646px'\r\n          }}\r\n        /> : null\r\n      }\r\n      {\r\n        pageLang === 'en' ?\r\n        <p>(Sorry for the shameless self promotion)</p> : null\r\n      }\r\n      {i18n[pageLang].loc.footer.disclaimer} /\r\n      <a href='https://github.com/chaosspam/DLDialogueScreenGenerator'> Github </a>\r\n      <br />\r\n      <select onChange={(e) => setLanguage(e.target.value)} defaultValue={pageLang} className='language-select'>\r\n        <option value='en'>English</option>\r\n        <option value='ja'></option>\r\n        <option value='zh_tw'></option>\r\n        <option value='zh_cn'></option>\r\n      </select>\r\n      <a href='https://ko-fi.com/N4N34N2U2' target='_blank' rel='noreferrer'>\r\n        <img\r\n          height='36'\r\n          style={{\r\n            border: '0px',\r\n            height: '24px',\r\n            verticalAlign: 'middle'\r\n          }}\r\n          src='https://cdn.ko-fi.com/cdn/kofi1.png?v=2'\r\n          alt='Buy Me a Coffee at ko-fi.com'\r\n        />\r\n      </a>\r\n    </footer>\r\n  );\r\n}\r\n\r\nexport default Footer;","export default __webpack_public_path__ + \"static/media/examplePortrait.2f3ada72.png\";","export default __webpack_public_path__ + \"static/media/exampleBackground.3620fd64.png\";","export default __webpack_public_path__ + \"static/media/bar.4929f2c4.png\";","export default __webpack_public_path__ + \"static/media/caption.bab1b2d4.png\";","export default __webpack_public_path__ + \"static/media/book.23b9009a.png\";","export default __webpack_public_path__ + \"static/media/fullscreen.3a2ec898.png\";","export default __webpack_public_path__ + \"static/media/introBack.a17405e5.png\";","export default __webpack_public_path__ + \"static/media/introBar.8ca3b360.png\";","export default __webpack_public_path__ + \"static/media/skip_ja.bdf4449a.png\";","export default __webpack_public_path__ + \"static/media/skip_zh_tw.f749ea76.png\";","import portrait from './examplePortrait.png';\r\nimport background from './exampleBackground.png';\r\nimport bar from './bar.png';\r\nimport caption from './caption.png';\r\nimport book from './book.png';\r\nimport fullscreen from './fullscreen.png';\r\nimport introBack from './introBack.png';\r\nimport introBar from './introBar.png';\r\nimport skip_ja from './skip_ja.png';\r\nimport skip_zh_tw from './skip_zh_tw.png';\r\nimport skip_zh_cn from './skip_zh_tw.png';\r\nimport skip_en from './skip_en.png';\r\nimport anger_l from './anger_l.png';\r\nimport anger_r from './anger_r.png';\r\nimport bad_l from './bad_l.png';\r\nimport bad_r from './bad_r.png';\r\nimport exclamation_l from './exclamation_l.png';\r\nimport exclamation_r from './exclamation_r.png';\r\nimport heart_l from './heart_l.png';\r\nimport heart_r from './heart_r.png';\r\nimport inspiration_l from './inspiration_l.png';\r\nimport inspiration_r from './inspiration_r.png';\r\nimport note_l from './note_l.png';\r\nimport note_r from './note_r.png';\r\nimport notice_l from './notice_l.png';\r\nimport notice_r from './notice_r.png';\r\nimport question_l from './question_l.png';\r\nimport question_r from './question_r.png';\r\nimport sleep_l from './sleep_l.png';\r\nimport sleep_r from './sleep_r.png';\r\nimport sweat_l from './sweat_l.png';\r\nimport sweat_r from './sweat_r.png';\r\n\r\nconst images = {\r\n  portrait,\r\n  background,\r\n  bar,\r\n  caption,\r\n  book,\r\n  fullscreen,\r\n  introBack,\r\n  introBar,\r\n  skip_ja,\r\n  skip_zh_tw,\r\n  skip_zh_cn,\r\n  skip_en,\r\n  anger_l,\r\n  anger_r,\r\n  bad_l,\r\n  bad_r,\r\n  exclamation_l,\r\n  exclamation_r,\r\n  heart_l,\r\n  heart_r,\r\n  inspiration_l,\r\n  inspiration_r,\r\n  note_l,\r\n  note_r,\r\n  notice_l,\r\n  notice_r,\r\n  question_l,\r\n  question_r,\r\n  sleep_l,\r\n  sleep_r,\r\n  sweat_l,\r\n  sweat_r,\r\n}\r\n\r\nexport default images;","export default __webpack_public_path__ + \"static/media/skip_en.56a96bac.png\";","export default __webpack_public_path__ + \"static/media/anger_l.b49aa0aa.png\";","export default __webpack_public_path__ + \"static/media/anger_r.a7ed1511.png\";","export default __webpack_public_path__ + \"static/media/bad_l.e6d64173.png\";","export default __webpack_public_path__ + \"static/media/bad_r.063a40b7.png\";","export default __webpack_public_path__ + \"static/media/exclamation_l.e90edc32.png\";","export default __webpack_public_path__ + \"static/media/exclamation_r.5c21d78f.png\";","export default __webpack_public_path__ + \"static/media/heart_l.30d5a57b.png\";","export default __webpack_public_path__ + \"static/media/heart_r.52eac19c.png\";","export default __webpack_public_path__ + \"static/media/inspiration_l.377c8010.png\";","export default __webpack_public_path__ + \"static/media/inspiration_r.1235858e.png\";","export default __webpack_public_path__ + \"static/media/note_l.7b3ad69e.png\";","export default __webpack_public_path__ + \"static/media/note_r.ddb88ab1.png\";","export default __webpack_public_path__ + \"static/media/notice_l.24f68bda.png\";","export default __webpack_public_path__ + \"static/media/notice_r.d5b17107.png\";","export default __webpack_public_path__ + \"static/media/question_l.7a927b79.png\";","export default __webpack_public_path__ + \"static/media/question_r.698466f4.png\";","export default __webpack_public_path__ + \"static/media/sleep_l.42f26c36.png\";","export default __webpack_public_path__ + \"static/media/sleep_r.91fec7d5.png\";","export default __webpack_public_path__ + \"static/media/sweat_l.c3c2dc95.png\";","export default __webpack_public_path__ + \"static/media/sweat_r.a171b0ac.png\";","import LayersPanel from './LayersPanel.js';\nimport SettingsPanel from './SettingsPanel.js';\nimport Footer from './Footer.js';\n\nimport { id, loadImage } from './Helper.js';\nimport images from './images/images.js';\nimport React from 'react';\nimport i18n from './data/i18n.json';\n\nconst furiganaSize = 15;\nconst emotionFromSide = 180;\nconst emotionYPos = 250;\nconst textures = {};\nlet drawing = false;\nlet layerId = 0;\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    let savedLang = localStorage.getItem('pageLanguage');\n    // If no saved language or language is not found, default to English\n    if(!savedLang || !i18n[savedLang])\n    {\n      savedLang = 'en';\n    }\n    document.documentElement.lang = i18n[savedLang].bcp47;\n    document.title = i18n[savedLang].loc.title;\n\n    this.state = {\n      // Screen drawing data\n      layers: [],\n      settings: {\n        speaker: i18n[savedLang].loc.settings.default.speaker,\n        dialogueText: i18n[savedLang].loc.settings.default.dialogueText,\n        dialogueType: 'dialogue',\n        font: savedLang,\n        emotion: 'none',\n        emotionSide: 'l',\n        emotionOffsetX: 0,\n        emotionOffsetY: 0\n      },\n      deletePromptActive: false,\n      pageLang: savedLang\n    };\n\n    this.updateLayer = this.updateLayer.bind(this);\n    this.updateSettings = this.updateSettings.bind(this);\n    this.addLayerDefault = this.addLayerDefault.bind(this);\n    this.removeLayer = this.removeLayer.bind(this);\n    this.reorderLayer = this.reorderLayer.bind(this);\n    this.drawDialogueScreen = this.drawDialogueScreen.bind(this);\n    this.setLanguage = this.setLanguage.bind(this);\n  }\n\n  componentDidMount() {\n    this.addLayer(i18n[this.state.pageLang].loc.layers.default.background, images.background);\n    this.addLayer(i18n[this.state.pageLang].loc.layers.default.portrait, images.portrait);\n    this.initialDraw();\n  }\n\n  render() {\n    return (\n      <div>\n        <h1 id=\"top\">{i18n[this.state.pageLang].loc.title}</h1>\n        <canvas id='preview' width='250' height='445'></canvas>\n        <section>\n          <LayersPanel\n            updateLayer={this.updateLayer}\n            addLayer={this.addLayerDefault}\n            removeLayer={this.removeLayer}\n            reorderLayer={this.reorderLayer}\n            drawDialogueScreen={this.drawDialogueScreen}\n            layers={this.state.layers}\n            pageLang={this.state.pageLang}\n          />\n          <SettingsPanel\n            settings={this.state.settings}\n            updateSettings={this.updateSettings}\n            pageLang={this.state.pageLang}\n          />\n        </section>\n        <canvas id='editor' width='750' height='1334' className='hidden'></canvas>\n        <Footer pageLang={this.state.pageLang} setLanguage={this.setLanguage}/>\n        <a href='#top' id='toTop'>To Top</a>\n      </div>\n    );\n  }\n\n  setLanguage(language) {\n    localStorage.setItem('pageLanguage', language);\n    document.documentElement.lang = i18n[language].bcp47;\n    document.title = i18n[language].loc.title;\n    this.setState({pageLang: language});\n  }\n\n  async initialDraw() {\n    try {\n      // Wait for fonts to load before drawing\n      await document.fonts.load('30px dragalialost_en');\n      await document.fonts.load('30px dragalialost_ja');\n      await document.fonts.load('30px dragalialost_zh_tw');\n      await document.fonts.load('30px dragalialost_zh_cn');\n\n      // Draw dialogue screen\n      await this.drawDialogueScreen();\n    } catch(e) {\n      console.error(e);\n    }\n  }\n\n  /**\n   * Draws the dialogue screen based on inputs\n   */\n  async drawDialogueScreen() {\n    if(drawing) return;\n    drawing = true;\n\n    // Get canvas context\n    const canvas = id('editor');\n    const preview = id('preview');\n    const ctx = canvas.getContext('2d');\n    const ctxPreview = preview.getContext('2d');\n\n    // Get draw type\n    const dialogueType = this.state.settings.dialogueType;\n    const lang =  this.state.settings.font;\n\n    // Clear the canvas\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctxPreview.clearRect(0, 0, preview.width, preview.height);\n\n    // Load images for use\n    await this.loadTextures();\n\n    let bar = textures.bar;\n\n    if(dialogueType === 'intro') {\n      bar = textures.introBar;\n      ctx.drawImage(textures.introBack, 0, 0);\n    }\n    if(dialogueType === 'caption' || dialogueType === 'narration') {\n      bar = textures.caption;\n    }\n    if(dialogueType === 'full') {\n      bar = textures.fullscreen;\n    }\n    if(dialogueType === 'book') {\n      ctx.drawImage(textures.book, 0, 0);\n      bar = textures['skip_' + lang];\n    }\n\n    // Draw Layers\n    for(let i = 0; i < this.state.layers.length; i++) {\n      let layer = this.state.layers[i];\n      this.drawImageWithData(ctx, id(`img_${layer.id}`), canvas.width / 2, canvas.height / 2, layer, dialogueType === 'intro')\n    }\n\n    await this.drawEmotion(ctx);\n\n    ctx.drawImage(bar, 0, 0);\n    // If language is not English, we draw the skip button in other language\n    if(lang !== 'en') {\n      ctx.drawImage(textures['skip_' + lang], 0, 0);\n    }\n\n    this.drawDialogueText(dialogueType, ctx, lang);\n\n    // Draw the editor canvas on the smaller preview canvas\n    ctxPreview.drawImage(canvas, 0, 0, preview.width, preview.height);\n\n    drawing = false;\n  }\n\n  async loadTextures() {\n    if(!textures.loaded) {\n      for(let key in images) {\n        textures[key] = await loadImage(images[key]);\n      }\n      textures.loaded = true;\n    }\n  }\n\n  /**\n   * Draws the image with given data\n   * @param {CanvasRenderingContext2D} ctx - Context of the canvas to draw on\n   * @param {number} centerX - Where to center the image's x position at\n   * @param {number} centerY - Where to center the image y position at\n   * @param {Object} layer - Data of the image\n   */\n  drawImageWithData(ctx, image, centerX, centerY, layer, dropShadow = false) {\n    // Sanitize the data passed in\n    centerX = parseFloat(centerX);\n    centerY = parseFloat(centerY);\n    let scale = parseFloat(layer.scale);\n    let offsetX = parseFloat(layer.offsetX);\n    let offsetY = -parseFloat(layer.offsetY);\n    let rotation = parseFloat(layer.rotation ? layer.rotation : 0);\n\n    let width = image.naturalWidth * scale;\n    let height = image.naturalHeight * scale;\n\n    let x = centerX - width / 2 + offsetX;\n    let y = centerY - height / 2 + offsetY;\n\n    // Save current context state\n    ctx.save();\n\n    // Move the context to the pivot before rotating\n    ctx.translate(centerX + offsetX, centerY + offsetY);\n\n    if(layer.flipX) {\n      ctx.scale(-1, 1);\n    }\n\n    if(rotation !== 0) {\n      ctx.rotate(rotation * Math.PI / 180);\n    }\n\n    if(dropShadow) {\n      ctx.shadowColor = 'rgba(0, 0, 0, .25)';\n      ctx.shadowOffsetX = 20;\n      ctx.shadowOffsetY = 20;\n    }\n\n    ctx.globalAlpha = layer.opacity;\n\n    ctx.translate(-centerX - offsetX, -centerY - offsetY);\n\n    ctx.drawImage(image, x, y, width, height);\n\n    // Restore original state\n    ctx.restore();\n  }\n\n  /**\n   * Draws the emotion balloon using context from canvas to draw on\n   * @param {CanvasRenderingContext2D} ctx - Context of the canvas to draw on\n   */\n  async drawEmotion(ctx) {\n    const { settings } = this.state\n\n    let emotionName = settings.emotion;\n    if (emotionName !== 'none') {\n      let emotionSide = settings.emotionSide;\n      emotionName += '_' + emotionSide;\n      const emotion = textures[emotionName];\n      this.drawImageWithData(ctx, emotion,\n        emotionSide === 'l' ? emotionFromSide : ctx.canvas.width - emotionFromSide,\n        emotionYPos,\n        {\n          'offsetX': settings.emotionOffsetX,\n          'offsetY': settings.emotionOffsetY,\n          'scale': 1\n        });\n    }\n  }\n\n  /**\n   * Draws the dialogue text using context from canvas to draw on\n   * @param {CanvasRenderingContext2D} ctx - Context of the canvas to draw on\n   * @param {string} lang - language of the font to draw with\n   */\n  drawDialogueText(dialogueType, ctx, lang) {\n    // Get text property and text to draw\n    const textProp = i18n[lang].textProperties;\n    const speakerName = id('name').value;\n    const dialogue = id('dialogue').value;\n\n    // Draw speaker name\n    ctx.textAlign = 'left';\n\n    ctx.font = `${textProp.nameSize}px dragalialost_${lang}`;\n    ctx.fillStyle = 'white';\n\n    if(dialogueType === 'caption') {\n      ctx.font = `${textProp.titleSize}px dragalialost_${lang}`;\n      ctx.fillText(speakerName, (ctx.canvas.width - ctx.measureText(speakerName).width) / 2, textProp.titleYPos);\n      ctx.fillRect(0, 430, ctx.canvas.width, 1);\n    } else if (dialogueType === 'intro') {\n      this.drawSpeakerNameIntro(ctx, textProp, lang, speakerName);\n    } else if(dialogueType !== 'narration' && dialogueType !== 'full' && dialogueType !== 'book') {\n      ctx.fillText(speakerName, textProp.speakerXPos, textProp.speakerYPos);\n    }\n\n    // Draw dialogue\n    let lines = dialogue.split('\\n');\n\n    let fontSize = textProp.dialogueSize;\n    let lineHeight = textProp.lineHeight;\n\n    let startX = textProp.dialogueXPos;\n    let startY = textProp.dialogueYPos;\n\n    ctx.fillStyle = '#071726';\n\n    if(dialogueType === 'intro') {\n      this.drawTitleIntro(ctx, textProp, lang, dialogue);\n      return;\n    }\n\n    let center = false;\n\n    if(dialogueType === 'caption') {\n      startY = textProp.captionYPos;\n      ctx.fillStyle = 'white';\n      fontSize = textProp.captionSize;\n      center = true;\n    } else if(dialogueType === 'narration' || dialogueType === 'full') {\n      fontSize = textProp.dialogueSize;\n      lineHeight = textProp.narrationLineHeight;\n      startY = textProp.narrationYPos - (fontSize + (lines.length - 1) * lineHeight) / 2;\n      ctx.fillStyle = 'white';\n      center = true;\n    } else if(dialogueType === 'book') {\n      fontSize = textProp.dialogueSize;\n      lineHeight = textProp.narrationLineHeight;\n      startY = ctx.canvas.height / 2 - ((lines.length - 1) * lineHeight) / 2;\n      ctx.fillStyle = '#412c29';\n      center = true;\n    }\n\n    ctx.font = `${fontSize}px dragalialost_${lang}`;\n\n    // Draw line by line\n    for (let i = 0; i < lines.length; i++) {\n      let x = startX;\n      if(center) {\n        let base = lines[i].replace(/\\(([^)]+)\\)\\{([^}]+)\\}/g, (match, base, furigana, offset, string) => base);\n        x = (ctx.canvas.width - ctx.measureText(base).width) / 2;\n      }\n      let y = startY + i * lineHeight;\n      this.drawDialogueLine(ctx, lang, lines[i], fontSize, x, y);\n    }\n  }\n\n  /**\n   * Draws a line of text starting at the provided position\n   * @param {CanvasRenderingContext2D} ctx - Context of the canvas to draw on\n   * @param {string} lang - Language of the font to draw with\n   * @param {string} text - Text to draw\n   * @param {number} fontSize - Default size of the dialogue text in provided language\n   * @param {number} startX - Starting x position to draw text from\n   * @param {number} startY - Starting y position to draw text from\n   */\n  drawDialogueLine(ctx, lang, text, fontSize, startX, startY) {\n    let tmp = '';\n    let last = 0;\n    const normalFont = `${fontSize}px dragalialost_${lang}`;\n    const furiganaFont = `${furiganaSize}px dragalialost_${lang}`;\n\n    // Draw the furigana first by removing them from the line\n    text = text.replace(/\\(([^)]+)\\)\\{([^}]+)\\}/g, (match, base, furigana, offset, string) => {\n      tmp += text.substring(last, offset);\n\n      // Use normal font size first\n      ctx.font = normalFont;\n      // Measure the length so far, add the half of the text below the furigana for the center\n      let center = startX + ctx.measureText(tmp).width + ctx.measureText(base).width / 2;\n\n      // Change to smaller font, measure where to start the furigana\n      ctx.font = furiganaFont;\n      let furiganaX = center - ctx.measureText(furigana).width / 2;\n      let furiganaY = startY - fontSize + 2;\n      ctx.fillText(furigana, furiganaX, furiganaY);\n\n      tmp += base;\n      last = offset + base.length + furigana.length + 4;\n\n      return base;\n    });\n\n    // Draw text without furigana\n    ctx.font = normalFont;\n    ctx.fillText(text, startX, startY);\n  }\n\n  /**\n   * Draws the speaker's name slanted for intro\n   * @param {CanvasRenderingContext2D} ctx\n   * @param {Object} textProp - property of the text\n   * @param {string} lang - Language of the font to draw with\n   * @param {string} speakerName - Text to draw\n   */\n  drawSpeakerNameIntro(ctx, textProp, lang, speakerName) {\n    ctx.save();\n\n    ctx.font = `${textProp.introNameSize}px dragalialost_${lang}`;\n    let textWidth = ctx.measureText(speakerName).width;\n\n    let x = ctx.canvas.width;\n    ctx.translate(x, textProp.introNameYPos);\n    ctx.rotate(-6.25 * Math.PI / 180);\n    ctx.translate(-x, -textProp.introNameYPos);\n\n    ctx.strokeStyle = '#333333';\n    ctx.lineWidth = 8;\n    ctx.miterLimit = 2;\n    ctx.strokeText(speakerName, ctx.canvas.width - textWidth - textProp.introXPos, textProp.introNameYPos);\n    ctx.fillText(speakerName, ctx.canvas.width - textWidth - textProp.introXPos, textProp.introNameYPos);\n\n    ctx.restore();\n  }\n\n  /**\n   * Draws the speaker's name slanted for intro\n   * @param {CanvasRenderingContext2D} ctx\n   * @param {Object} textProp - property of the text\n   * @param {string} lang - Language of the font to draw with\n   * @param {string} speakerName - Text to draw\n   */\n  drawTitleIntro(ctx, textProp, lang, text) {\n    ctx.save();\n\n    ctx.font = `${textProp.introTitleSize}px dragalialost_${lang}`;\n    let textWidth = ctx.measureText(text).width;\n\n    let x = ctx.canvas.width;\n    ctx.translate(x, textProp.introTitleYPos);\n    ctx.rotate(-6.25 * Math.PI / 180);\n    ctx.translate(-x, -textProp.introTitleYPos);\n\n    ctx.fillStyle = '#333333';\n    ctx.fillText(text, ctx.canvas.width - textWidth - textProp.introXPos, textProp.introTitleYPos);\n\n    ctx.restore();\n  }\n\n  /**\n   * Add a new default layer\n   * @param {string} layerName - Name of the new layer to add\n   * @param {string} imgSrc - Image source for the new layer\n   */\n  addLayerDefault() {\n    let pageLang = document.documentElement.lang;\n    return this.addLayer(`${i18n[pageLang].loc.layers.layer} ${this.state.layers.length + 1}`, images.portrait);\n  }\n\n  /**\n   * Add a new layer\n   * @param {string} layerName - Name of the new layer to add\n   * @param {string} imgSrc - Image source for the new layer\n   */\n  addLayer(layerName, imgSrc) {\n    // Get a new id\n    const layerId = this.getNewId();\n    // Create data for new layer\n    let newLayer = {\n      'name': layerName,\n      'id': layerId,\n      'image': imgSrc,\n      'offsetX': 0,\n      'offsetY': 0,\n      'rotation': 0,\n      'scale': 1,\n      'opacity': 1,\n      'flipX': false\n    }\n    this.setState((prevState) => { return { layers: [...prevState.layers, newLayer ] }; }, this.drawDialogueScreen);\n    return newLayer;\n  }\n\n  /**\n   * Remove the layer that is set to be removed\n   */\n  removeLayer(id) {\n    if(this.state.layers.length <= 1) return;\n    this.setState((prevState) => { return { layers: prevState.layers.filter(layer => layer.id !== id) }; }, this.drawDialogueScreen);\n  }\n\n  /**\n   * Reorder the layers based on the document order\n   */\n  reorderLayer(result) {\n    if(result.over) {\n      // Get the tabs\n      this.setState((prevState) => {\n        const layers = [...prevState.layers];\n        const fromIndex = layers.findIndex(x => `tab_${x.id}` === result.active.id);\n        const toIndex = layers.findIndex(x => `tab_${x.id}` === result.over.id);\n        if(fromIndex !== -1 && toIndex !== -1 && fromIndex !== toIndex) {\n          const tmp = layers[fromIndex];\n          const dir = toIndex < fromIndex ? -1 : 1;\n          for (let i = fromIndex; i !== toIndex; i += dir) {\n            layers[i] = layers[i + dir];\n          }\n          layers[toIndex] = tmp;\n        }\n        return { layers: layers };\n      }, this.drawDialogueScreen);\n    }\n  }\n\n  updateLayer(updateLayerId, updated) {\n    this.setState(prevState => {\n      return {\n        layers: prevState.layers.map(layer => layer.id === updateLayerId ? Object.assign(layer, updated) : layer)\n      };\n    }, this.drawDialogueScreen);\n  }\n\n  updateSettings(updated) {\n    this.setState(prevState => {\n      return {\n        settings: Object.assign(prevState.settings, updated)\n      };\n    }, this.drawDialogueScreen);\n  }\n\n  /**\n   * Generate a new id to associate with a new layer\n   * @returns {number} A new number id\n   */\n  getNewId() {\n    layerId++;\n    return layerId;\n  }\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}